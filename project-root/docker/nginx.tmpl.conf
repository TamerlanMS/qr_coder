server {
    listen 80;
    server_name _;

    root /usr/share/nginx/html;
    index index.html;

    # SPA fallback
    location / {
        try_files $uri /index.html;
    }

    # Прокси в 1С (адрес берём из переменной ONEC_URL)
    # Примеры:
    #   ONEC_URL=http://host.docker.internal:8080/gourme_container/hs/GourmetContainer
    #   ONEC_URL=http://192.168.1.50:8080/gourme_container/hs/GourmetContainer
    location /api/container {
        proxy_pass $ONEC_URL;

        # (на будущее) CORS-заголовки — не мешают, но в одном origin не нужны
        add_header Access-Control-Allow-Origin * always;
        add_header Access-Control-Allow-Methods "POST, OPTIONS" always;
        add_header Access-Control-Allow-Headers "Content-Type, Authorization" always;
        if ($request_method = OPTIONS) { return 204; }
    }
}
